{"cells":[{"cell_type":"markdown","metadata":{"id":"WL1YQsl2anrD"},"source":["# Парсинг"]},{"cell_type":"markdown","metadata":{"id":"ePM2pdYqi5uh"},"source":["Критерии отбора каналов:\n","\n","- канал ведет один автор, а не коллектив;\n","- тексты на канале должны быть достаточного объема, выражающие законченную позицию автора, а не в формате подписи к видео;\n","- статьи каждого автора в датасет попадают один раз, в виде выборки последних 10-12 статей с канала либо в виде подборки постов на определенную тему, составленной самим автором;\n","- каналы сгруппированы в 5 групп по отношению к России и СССР, плюс одна группа контрольная (на нейтральные темы)."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mqRtqy66zugE"},"outputs":[],"source":["USSR_history_bad = [\n","'USSR_history_bad',\n","'https://dzen.ru/radzinsky', # Радзинский, история\n","'https://dzen.ru/storiymironovanton', # Миронов Антон, история\n","'https://dzen.ru/nkvd_tomsk', # НКВД Томск, история гулага\n","'https://dzen.ru/valerongrach', # Валерий Грачиков, история про все подряд\n","'https://dzen.ru/cyrilsh', # Кирилл Шишкин, история военная\n","'https://dzen.ru/gulagmuseum', # музей Гулага, история гулага\n","'https://dzen.ru/nodal_points', #Узловые точки, история\n","'https://dzen.ru/lifeel', # Жизнь и чувства, путешествия\n","'https://dzen.ru/kino35mm?tab=articles', # 35мм, о кино\n","'https://dzen.ru/suite/1ae0dae7-8974-4434-aa8e-e31df1114749', # Кинораритет_Шедевры совковой пропаганды\n","'https://dzen.ru/suite/c55bda5f-2e03-467c-a28e-1a702c61e490', # Север неизвестный_Гулаг\n","'https://dzen.ru/naumpridy', # Наум приди, повседневное\n","'https://dzen.ru/suite/2fcc23ca-44bd-4bea-baac-fe83ea6f5ac0', # Дм.Линдер_СССР\n","'https://dzen.ru/russkayadoroga', #Русская дорога, путешествия\n","'https://dzen.ru/ivanafanasyevcineman', # Кинокритика экс-курильщика\n","'https://dzen.ru/suite/05ec642b-8d29-40aa-b885-a6c3021a666e', # Частные суждения_Вокруг истории\n","'https://dzen.ru/id/5f6e400963b25d04cdc4715c', # История СССР в документах\n","'https://dzen.ru/suite/03aeae66-aab2-4307-9f02-3a267cb67bc1', # Только факты_СССР, история, подборки\n","]\n","\n","Russia_bad_relocate = [\n","'Russia_bad_relocate',\n","'https://dzen.ru/poravalit', # Пора валить\n","'https://dzen.ru/grammarnazi', # Граммарнаци\n","'https://dzen.ru/ianchevskii_coach', # Янчевский, релокант, о России нет\n","'https://dzen.ru/kinovinoda', # Кино, вино и домино, повседневное\n","'https://dzen.ru/tonych_inc', # Антон Соколов, эмигрировал в Аргентину, о России нет\n","'https://dzen.ru/suite/acd54704-d3e0-423a-a66f-323bca3cf5e9', # Азбука иммигранта_истории, о России нет\n","'https://dzen.ru/suite/4a2d40c5-d60c-4b92-84d0-8f5ef3c1bfbf', # Рябинин Фотопутешествия_Безвременье России\n","'https://dzen.ru/varlamov', # Илья Варламов, путешествия, подборки, Russia bad\n","'https://dzen.ru/relocator', # Релокатор, инструкции\n","'https://dzen.ru/kutovoy', # Кутовой про путешествия, релокант\n","'https://dzen.ru/suite/57c2d0cb-1344-4baa-b065-832b5eeba4ea', # Першы_Граница за бугром, белорус и релокации\n","'https://dzen.ru/id/5b7d8177dfb56c00aa5bae01', # Жизнь в Испании\n","'https://dzen.ru/id/5f66ed54035867603accfb20', # Простые решения\n","'https://dzen.ru/romannews', # Роман без веры\n","]\n","\n","Russia_good_USSR_bad = [\n","'Russia_good_USSR_bad',\n","'https://dzen.ru/sergeytsvetkov.livejournal.com', # Сергей Цветков\n","'https://dzen.ru/olegalifanov', # Олег Алифанов, текущее и история\n","'https://dzen.ru/history_for_chayniks', # филиал Карамзина, обо всем, книги\n","'https://dzen.ru/makarenko', #Олег Макаренко, история, политика\n","'https://dzen.ru/monarchistyrossii', # державное движение России\n","'https://dzen.ru/holmogorow', # Егор Холмогоров\n","'https://dzen.ru/suite/c9b2d40c-209b-4502-959b-0a7785f77385', # Суаре у Клио_История каждый день, неглубоко\n","'https://dzen.ru/id/62fca0cbee4d01308eca0ff0', # Мысли о России\n","'https://dzen.ru/id/64ce49dabbd9a65c8d5b8ea9' # Невыдуманные истории\n","]\n","\n","Russia_good = [\n","'Russia_good',\n","'https://dzen.ru/politicanow', # Олег Адольфович, текущая политика, про СССР нет\n","'https://dzen.ru/1politic_amateur', # Дилетант о политике, текущая политика\n","'https://dzen.ru/delaychehochesh', # Делайчехочешь, путешествия, неглубоко обо всем\n","'https://dzen.ru/suite/a6fb69cc-d703-410e-9db5-e06de97aa9bb', # Борис Новицкий, публицистика\n","'https://dzen.ru/suite/2d5f79fb-fa23-4609-a628-ac25e3f80645', # Объясняю на пальцах_Успехи России, пропагандист\n","'https://dzen.ru/tuatamur', # Сергей Рязанцев\n","'https://dzen.ru/suite/a3418b11-fe4f-412b-882e-77346371cb7b', # Путь к свободе_Все будет хорошо, автомаляр\n","'https://dzen.ru/id/5d1262217dc1f900b030f7bd', # Natalia Szerebriakova\n","'https://dzen.ru/id/626c50016fef4843017cb83a', # Александр Дугин\n","'https://dzen.ru/id/6227a9b658447620366383e4' # п0нты м0рала\n","]\n","\n","USSR_history_good = [\n","'USSR_history_good',\n","'https://dzen.ru/luchik', # журнал Лучик, текущие мысли\n","'https://dzen.ru/mem', # Мемуарист, Сталин хорошо\n","'https://dzen.ru/stalin_tt', # Так делал Сталин\n","'https://dzen.ru/lev_valerich',  # Лев Валерьич, Сталин хорошо\n","'https://dzen.ru/whs', # Всемирная история, история старая\n","'https://dzen.ru/sovietman', # СССР\n","'https://dzen.ru/rakshasendra', # История от историка, история\n","'https://dzen.ru/nasha_istoria_eto_gordost?tab=articles', # Наша история это гордость, история военная\n","'https://dzen.ru/historian_trishkin', # Школьный историк Тришкин,история, текущая политика\n","'https://dzen.ru/dark_historian', # Темный историк, история\n","'https://dzen.ru/aryan', # Ариян, текущие события\n","'https://dzen.ru/suite/a41754f1-fd21-451c-b239-45aeb4d14c4f', # Война и Homo Sapiens_Мифы сталинской эпохи\n","'https://dzen.ru/suite/b82da295-b308-44f2-856c-30efcb2c762a', # Жанна Швыдкая_Россия будущего, текущая политика\n","'https://dzen.ru/suite/0d9dea28-e192-4b9d-b049-e0f207706c6f', # Андрей Фурсов_ Загадки истории, политика\n","'https://dzen.ru/suite/a50ecd6a-27ee-4255-8bf4-71f556f980b3', # Билет в СССР_Блокада Ленинграда\n","'https://dzen.ru/suite/2f041ff4-bab8-46dd-9036-c3b1736e484f', # История с Андреем Журавлевым_Сталинград\n","'https://dzen.ru/suite/8bb7700c-10c3-49ff-b846-8c684def7f20', # Историк Игорь Гусев рассказывает_О русских, история\n","'https://dzen.ru/suite/7fd48eea-b56a-403c-9762-d9d041aa891c', # Точка опоры_СВО, текущая политика\n","'https://dzen.ru/suite/0726fc7d-e293-414c-83d1-8dc55e9740bc', # Изнанка политики_Статьи на историческую тематику\n","'https://dzen.ru/suite/c06579ac-03e1-426a-af4b-a4e1471c3fbb', # Часовой истории_Про Сталина, публицистика\n","'https://dzen.ru/suite/84da1f7a-6e2c-4bf4-9a77-79d0d34f26bd', # Журнал Фотон_О развале СССР, философия\n","'https://dzen.ru/suite/f948b8e8-99cb-4d73-b526-b6643c0a2c17'  # Уральский историк_Урал в годы ВОВ\n","]\n","\n","neutral = [\n","'neutral',\n","'https://dzen.ru/andreykurpatov', # Андрей Курпатов, психология\n","'https://dzen.ru/galereus', # Галереус, о селебрити\n","'https://dzen.ru/shishoninblog', # Доктор Шишонин, здоровье\n","'https://dzen.ru/nikamarsh', # Ника Марш, история, селебрити\n","'https://dzen.ru/sevprostor', # Севпростор, история, этно\n","'https://dzen.ru/morena', # Морена Морана, публицистика, текущее\n","'https://dzen.ru/motherdragon', # Дракон старой гвардии, публицистика, текущее\n","'https://dzen.ru/prodiagnosi', # Про Диагнозы, здоровье\n","'https://dzen.ru/yaplusoni.ru', # СветЛость, история, текущее\n","'https://dzen.ru/kameralkin', # Камералкин, налог.истории\n","'https://dzen.ru/dubrovskiy', # Юрист-юморист, юрид.истории\n","'https://dzen.ru/iqladies', # IQ Ladies, косметология\n","'https://dzen.ru/anna_kiryanova', # Анна Кирьянова, философия\n","'https://dzen.ru/masternavseruki', # Мастер на все руки\n","'https://dzen.ru/18081981', # Фельдшер, мед.истории\n","'https://dzen.ru/id/592d7dfc7ddde88dbd5afbd3', # Записки кинезиолога, психология\n","'https://dzen.ru/vmesteproject', # вМесте, дети и воспитание\n","'https://dzen.ru/tsaler', # Музыка, история, открытия, мифы\n","'https://dzen.ru/pochtipp', # Почти ПП, про вино\n","'https://dzen.ru/toadstool', # Это грибы, про грибы\n","'https://dzen.ru/bleedkitsune', # Креативный кот, неглубоко о повседневном\n","'https://dzen.ru/bibliojulia', # БиблиоЮлия, про книги\n","'https://dzen.ru/inznan', # Инженерные знания\n","'https://dzen.ru/pavelzygmantovich', # Психология с Павлом Зыгмантовичем\n","'https://dzen.ru/dnevnik_rolevika', # Дневник ролевика, историческое оружие\n","'https://dzen.ru/lifeinengland', # Жизнь в Англии\n","'https://dzen.ru/obelarusi', # Евгений и Дарья Олейники, путешествия, повседневное\n","'https://dzen.ru/id/5cb1306e456a7000b3a19c3d', # Елена Чудинова, текущая политика\n","'https://dzen.ru/id/64ad4d3daaa8fc624d632781', # Мама на Дзене, неглубоко о повседневном\n","'https://dzen.ru/flowersforal', # Цветы для Элджернона, психология\n","'https://dzen.ru/id/5cb1306e456a7000b3a19c3d', # Елена Чудинова, писатель\n","'https://dzen.ru/teacher',  # Mr.Teacher, учитель\n","'https://dzen.ru/vvoronova'  # Вероника Воронова, инженер\n","]\n","\n","url_list = [USSR_history_bad, Russia_bad_relocate, Russia_good_USSR_bad, Russia_good, USSR_history_good, neutral]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":50,"status":"ok","timestamp":1743484192235,"user":{"displayName":"Tatiana Chernova","userId":"14499696604272654483"},"user_tz":-180},"id":"u5aylLHOcoQ_","outputId":"056fcf21-8b1b-40a7-d87a-2b92249d7e0a"},"outputs":[{"output_type":"stream","name":"stdout","text":["СССР_история_плохо  18\n","Россия_плохо  14\n","Россия_хорошо_СССР_плохо  9\n","Россия хорошо 10\n","СССР_история_хорошо  22\n","Контрольная группа  33\n","Всего каналов  106\n"]}],"source":["print('СССР_история_плохо ', len(USSR_history_bad)-1)\n","print('Россия_плохо ', len(Russia_bad_relocate)-1)\n","print('Россия_хорошо_СССР_плохо ', len(Russia_good_USSR_bad)-1)\n","print('Россия хорошо', len(Russia_good)-1)\n","print('СССР_история_хорошо ', len(USSR_history_good)-1)\n","print('Контрольная группа ', len(neutral)-1)\n","\n","# кол-во элементов списка, не являющихся url-ами\n","idle_urls = len(url_list)\n","\n","total_length = 0\n","for item in url_list:\n","  total_length += len(item)\n","print('Всего каналов ', total_length-idle_urls)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3471,"status":"ok","timestamp":1739636654037,"user":{"displayName":"Tatiana Chernova","userId":"14499696604272654483"},"user_tz":-300},"id":"Djc-2oU1-sHa","outputId":"24e7149b-e5e8-4993-9ad0-8481dbf6b733"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: selenium in /usr/local/lib/python3.11/dist-packages (4.28.1)\n","Requirement already satisfied: urllib3<3,>=1.26 in /usr/local/lib/python3.11/dist-packages (from urllib3[socks]<3,>=1.26->selenium) (2.3.0)\n","Requirement already satisfied: trio~=0.17 in /usr/local/lib/python3.11/dist-packages (from selenium) (0.29.0)\n","Requirement already satisfied: trio-websocket~=0.9 in /usr/local/lib/python3.11/dist-packages (from selenium) (0.12.0)\n","Requirement already satisfied: certifi>=2021.10.8 in /usr/local/lib/python3.11/dist-packages (from selenium) (2025.1.31)\n","Requirement already satisfied: typing_extensions~=4.9 in /usr/local/lib/python3.11/dist-packages (from selenium) (4.12.2)\n","Requirement already satisfied: websocket-client~=1.8 in /usr/local/lib/python3.11/dist-packages (from selenium) (1.8.0)\n","Requirement already satisfied: attrs>=23.2.0 in /usr/local/lib/python3.11/dist-packages (from trio~=0.17->selenium) (25.1.0)\n","Requirement already satisfied: sortedcontainers in /usr/local/lib/python3.11/dist-packages (from trio~=0.17->selenium) (2.4.0)\n","Requirement already satisfied: idna in /usr/local/lib/python3.11/dist-packages (from trio~=0.17->selenium) (3.10)\n","Requirement already satisfied: outcome in /usr/local/lib/python3.11/dist-packages (from trio~=0.17->selenium) (1.3.0.post0)\n","Requirement already satisfied: sniffio>=1.3.0 in /usr/local/lib/python3.11/dist-packages (from trio~=0.17->selenium) (1.3.1)\n","Requirement already satisfied: wsproto>=0.14 in /usr/local/lib/python3.11/dist-packages (from trio-websocket~=0.9->selenium) (1.2.0)\n","Requirement already satisfied: pysocks!=1.5.7,<2.0,>=1.5.6 in /usr/local/lib/python3.11/dist-packages (from urllib3[socks]<3,>=1.26->selenium) (1.7.1)\n","Requirement already satisfied: h11<1,>=0.9.0 in /usr/local/lib/python3.11/dist-packages (from wsproto>=0.14->trio-websocket~=0.9->selenium) (0.14.0)\n"]}],"source":["!pip install selenium"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dM44LENN-ufn"},"outputs":[],"source":["from bs4 import BeautifulSoup\n","from selenium import webdriver\n","from selenium.webdriver.chrome.options import Options\n","import json\n","import csv\n","import time\n","import pandas as pd\n","import random\n","from random import randint\n","import os.path\n","from os import path"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1ni4op3leIwa"},"outputs":[],"source":["chrome_options = Options()\n","chrome_options.add_argument(\"--headless\")\n","chrome_options.add_argument(\"--start-maximized\")\n","chrome_options.add_argument(\"--disable-extensions\")\n","chrome_options.add_argument(\"--no-sandbox\")\n","chrome_options.add_argument(\"--disable-dev-shm-usage\")\n","chrome_options.add_argument('--blink-settings=imagesEnabled=false')\n","chrome_options.add_argument(\"--window-size=1920x1080\")\n","#chrome_options.timeouts = { 'pageLoad': 5000 }\n","#chrome_options.timeouts = { 'script': 5000 }\n","\n","user_agent_list = [\n","    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36',\n","    'Mozilla/5.0 (iPhone; CPU iPhone OS 14_4_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Mobile/15E148 Safari/604.1',\n","    'Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1)',\n","    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Edg/87.0.664.75',\n","    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18363',\n","    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/114.0.5735.106 Safari/537.36',\n","    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36',\n","    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36\",\n","    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\",\n","    \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36\",\n","    \"Mozilla/5.0 (iPhone14,3; U; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Mobile/19A346 Safari/602.1\"\n","    ]"]},{"cell_type":"markdown","metadata":{"id":"fYyrmZoxs4Yj"},"source":["**Получаем ссылки по группам url-ов**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"14YcXDxq8mCD"},"outputs":[],"source":["def get_links(page, channel_name):\n","\n","    link_list=[]\n","    clean_links = []\n","    for a in page.find_all('a', href=True):\n","        link_list.append(a['href'])\n","    for item in link_list:\n","        if 'ordinary_feed' in str(item):   # ссылки на статьи, а не видео\n","          item = item.split('?')[0]\n","          clean_links.append(item)\n","    end_links = list(set(clean_links))\n","\n","    with open(f'./{channel_name}.json', 'w', encoding=\"utf-8\") as file:\n","          json.dump({\"канал\": channel_name,\n","                  \"ссылки\": end_links},\n","                  file, ensure_ascii=False, indent=4)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":84274,"status":"ok","timestamp":1736693769007,"user":{"displayName":"Tatiana Chernova","userId":"14499696604272654483"},"user_tz":-180},"id":"KbH9JoxY8Yr-","outputId":"e4ea6d1a-5f89-4eb0-a133-c7a3f3e8c431"},"outputs":[{"name":"stdout","output_type":"stream","text":["Scraping url_group neutral\n","Scraping url https://dzen.ru/andreykurpatov\n","Url processed\n","Scraping url https://dzen.ru/vvoronova\n","Url processed\n","Scraping url https://dzen.ru/flowersforal\n","Url processed\n","Scraping url https://dzen.ru/teacher\n","Url processed\n","Scraping finished\n"]}],"source":["for url_group in url_list:\n","    json_path = f'/content/drive/MyDrive/Colab Notebooks/VKR/zen_link_data_v2/{url_group[0]}'\n","    if path.exists(json_path) == False:\n","        os.makedirs(json_path)\n","    os.chdir(json_path)\n","    print('Scraping url_group', url_group[0])\n","\n","    for url in url_group[1::]:\n","\n","        random_user_agent = random.choice(user_agent_list)\n","        chrome_options.add_argument(f\"--user-agent={random_user_agent}\")\n","        driver = webdriver.Chrome(options=chrome_options)\n","        driver.get(url)\n","        driver.maximize_window()\n","        print('Scraping url', url)\n","\n","        time.sleep(random.choice(range(3, 6, 1)))\n","\n","        page = BeautifulSoup(driver.page_source, 'lxml')\n","\n","        try:\n","          channel_name = page.find(itemprop = 'name').text   #для каналов\n","        except:\n","          channel_name = page.find(class_='desktop2--channel-info__title-24 desktop2--channel-info__isGray-3- desktop2--channel-info__titleSize1520-CM').text  #для подборок\n","        try:\n","          suite_name = page.find(class_=\"desktop2--suite-header__name-1A desktop2--suite-header__platformDesktop-YL\").text\n","        except:\n","          suite_name =''\n","\n","        link_list=[]\n","        clean_links = []\n","        for a in page.find_all('a', href=True):\n","          link_list.append(a['href'])\n","        for item in link_list:\n","          if 'ordinary_feed' in str(item):   # ссылки на статьи, а не видео\n","            item = item.split('?')[0]\n","            clean_links.append(item)\n","        end_links = list(set(clean_links))\n","\n","        with open(f'./{channel_name}_{suite_name}.json', 'w', encoding=\"utf-8\") as file:\n","          json.dump({\"канал\": channel_name,\n","                  \"подборка\": suite_name,\n","                  \"ссылки\": end_links},\n","                  file, ensure_ascii=False, indent=4)\n","        print(f'Url processed')\n","\n","        driver.quit()\n","\n","print('Scraping finished')\n"]},{"cell_type":"markdown","metadata":{"id":"GjGLIvHys_cw"},"source":["**Получаем тексты по собранным ссылкам**"]},{"cell_type":"code","source":["url_list = [neutral]"],"metadata":{"id":"jZIQt8S8atLv"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Qfj-NQVSDlV-","executionInfo":{"status":"ok","timestamp":1739805254380,"user_tz":-300,"elapsed":157115458,"user":{"displayName":"Tatiana Chernova","userId":"14499696604272654483"}},"outputId":"ded0116b-3dbe-42d0-bcf8-9b4d0e15a205"},"outputs":[{"output_type":"stream","name":"stdout","text":["Processing json_folder neutral\n","Processing IQ Ladies _ Блог нейрокосметолога Алевтины Коротовской_.json\n","IQ Ladies _ Блог нейрокосметолога Алевтины Коротовской_.json scraped, 12 links processed\n","IQ Ladies _ Блог нейрокосметолога Алевтины Коротовской_.json saved to csv\n","Processing БиблиоЮлия_.json\n","БиблиоЮлия_.json scraped, 14 links processed\n","БиблиоЮлия_.json saved to csv\n","Processing Вероника Воронова. Инженер на выгуле_.json\n","Вероника Воронова. Инженер на выгуле_.json scraped, 12 links processed\n","Вероника Воронова. Инженер на выгуле_.json saved to csv\n","Processing ГалереуС_.json\n","ГалереуС_.json scraped, 12 links processed\n","ГалереуС_.json saved to csv\n","Processing Евгений и Дарья Олейники_.json\n","Евгений и Дарья Олейники_.json scraped, 12 links processed\n","Евгений и Дарья Олейники_.json saved to csv\n","Processing Занимательная диагностика _ Pro.Diagnosi_.json\n","Занимательная диагностика _ Pro.Diagnosi_.json scraped, 13 links processed\n","Занимательная диагностика _ Pro.Diagnosi_.json saved to csv\n","Processing Креативный Кот_.json\n","Креативный Кот_.json scraped, 12 links processed\n","Креативный Кот_.json saved to csv\n","Processing Мr.Teacher_.json\n","Мr.Teacher_.json scraped, 12 links processed\n","Мr.Teacher_.json saved to csv\n","Processing Мастер на все руки_.json\n","Мастер на все руки_.json scraped, 13 links processed\n","Мастер на все руки_.json saved to csv\n","Processing Морена Морана_.json\n","Морена Морана_.json scraped, 12 links processed\n","Морена Морана_.json saved to csv\n","Processing Музыка. История, открытия, мифы_.json\n","Музыка. История, открытия, мифы_.json scraped, 13 links processed\n","Музыка. История, открытия, мифы_.json saved to csv\n","Processing Ника Марш_.json\n","Ника Марш_.json scraped, 12 links processed\n","Ника Марш_.json saved to csv\n","Processing Почти ПП_.json\n","Почти ПП_.json scraped, 12 links processed\n","Почти ПП_.json saved to csv\n","Processing Саша Док. Истории «03»_.json\n","Саша Док. Истории «03»_.json not scraped, 1 links processed\n","Саша Док. Истории «03»_.json saved to csv\n","Processing СветЛость_.json\n","СветЛость_.json scraped, 12 links processed\n","СветЛость_.json saved to csv\n","Processing Цветы для Элджернона_.json\n","Цветы для Элджернона_.json scraped, 12 links processed\n","Цветы для Элджернона_.json saved to csv\n","Processing Это грибы!_.json\n","Это грибы!_.json scraped, 12 links processed\n","Это грибы!_.json saved to csv\n","Processing вМесте_.json\n","вМесте_.json scraped, 14 links processed\n","вМесте_.json saved to csv\n","Processing дневник ролевика_.json\n","дневник ролевика_.json scraped, 13 links processed\n","дневник ролевика_.json saved to csv\n","Processing Юрист-юморист_.json\n","Юрист-юморист_.json scraped, 13 links processed\n","Юрист-юморист_.json saved to csv\n","Processing Фельдшер_.json\n","Фельдшер_.json scraped, 12 links processed\n","Фельдшер_.json saved to csv\n","Processing Камералкин_.json\n","Камералкин_.json scraped, 12 links processed\n","Камералкин_.json saved to csv\n","Processing Жизнь в Англии_.json\n","Жизнь в Англии_.json scraped, 11 links processed\n","Жизнь в Англии_.json saved to csv\n","Processing Дракон старой гвардии_.json\n","Дракон старой гвардии_.json scraped, 13 links processed\n","Дракон старой гвардии_.json saved to csv\n","Processing Блог Доктора Шишонина_.json\n","Блог Доктора Шишонина_.json scraped, 13 links processed\n","Блог Доктора Шишонина_.json saved to csv\n","Processing Анна Кирьянова. Философия жизни._.json\n","Анна Кирьянова. Философия жизни._.json scraped, 13 links processed\n","Анна Кирьянова. Философия жизни._.json saved to csv\n","Processing Андрей Курпатов_.json\n","Андрей Курпатов_.json scraped, 12 links processed\n","Андрей Курпатов_.json saved to csv\n","Processing sevprostor_.json\n","sevprostor_.json scraped, 14 links processed\n","sevprostor_.json saved to csv\n","Processing Елена Чудинова_.json\n","Елена Чудинова_.json scraped, 12 links processed\n","Елена Чудинова_.json saved to csv\n","Processing Записки кинезиолога_.json\n","Записки кинезиолога_.json scraped, 12 links processed\n","Записки кинезиолога_.json saved to csv\n","Processing Мама на дзене_.json\n","Мама на дзене_.json scraped, 12 links processed\n","Мама на дзене_.json saved to csv\n","Processing Инженерные знания_.json\n","Инженерные знания_.json scraped, 12 links processed\n","Инженерные знания_.json saved to csv\n","\n","Total links saved 12\n","\n","Total csv_files saved 32\n"]}],"source":["file_counter = 0\n","for url_group in url_list:\n","    json_folder = f'/content/drive/MyDrive/Colab Notebooks/VKR/zen_dataframe_v2/{url_group[0]}'\n","    print('Processing json_folder', url_group[0])\n","\n","    os.chdir(json_folder)\n","    json_files = [pos_json for pos_json in os.listdir(json_folder) if pos_json.endswith('.json')]\n","\n","    for json_file in json_files:\n","      link_counter = 0\n","      with open(json_file) as f:\n","          data = json.load(f)\n","          print(f'Processing {json_file}')\n","\n","          channel, subscribers, reads, dates, links, heads, texts = [], [], [], [], [], [], []\n","\n","          try:\n","            for link in data['ссылки']:\n","              random_user_agent = random.choice(user_agent_list)\n","              chrome_options.add_argument(f\"--user-agent={random_user_agent}\")\n","              driver = webdriver.Chrome(options=chrome_options)\n","\n","              driver.get(link)\n","              driver.maximize_window()\n","\n","              time.sleep(random.choice(range(3, 6, 1)))\n","              page = BeautifulSoup(driver.page_source, 'lxml')\n","\n","              channel.append(page.find(class_='content--publisher-block-inline__channelName-wv').text)\n","\n","              links.append(link)\n","              try:\n","                heads.append(page.find('h1').text) #для каналов\n","              except:\n","                heads.append(page.find(class_='content--article-render__title-1g').text)# для подборок\n","              dates.append(page.find(class_=\"content--article-info-block__shortFormat-1v\").text.replace('\\xa0', ' '))\n","              reads.append(page.find_all(class_='content--article-info-block__viewsInfo-1g')[1].text)\n","              subscribers.append(page.find(class_=\"content--meta__meta-33\").text)\n","              texts.append(' '.join((map(lambda tag: tag.text, page.find_all(class_=\"content--common-block__block-3U\")))))\n","\n","              link_counter += 1\n","              driver.quit()\n","\n","            print(f'{json_file} scraped, {link_counter} links processed')\n","          except:\n","            print(f'{json_file} not scraped, {link_counter} links processed')\n","\n","          try:\n","            df_columns = ['group', 'channel', 'subscribers', 'reads', 'dates', 'links', 'heads', 'texts']\n","            df = pd.DataFrame({'group': url_group[0],\n","                      'channel': channel,\n","                      'subscribers': subscribers,\n","                      'reads': reads,\n","                      'dates': dates,\n","                      'links': links,\n","                      'heads': heads,\n","                      'texts': texts})\n","\n","            saving_path = f'/content/drive/MyDrive/Colab Notebooks/VKR/zen_dataframe_v2/{url_group[0]}'\n","            os.chdir(saving_path)\n","            df.to_csv(f'./{channel[0]}.csv')\n","            print(f'{json_file} saved to csv')\n","            file_counter+=1\n","\n","          except:\n","            print(f'{json_file} not saved to csv')\n","\n","print(f'\\nTotal links saved {link_counter}')\n","print(f'\\nTotal csv_files saved {file_counter}')"]},{"cell_type":"markdown","metadata":{"id":"q52Q_vArh5tD"},"source":["**Построение df**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2Gq5jRLnh8Eu"},"outputs":[],"source":["import json\n","import csv\n","import time\n","import pandas as pd\n","import random\n","from random import randint\n","import os.path\n","from os import path"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JglDvOcji97V"},"outputs":[],"source":["url_list = [USSR_history_bad, Russia_bad_relocate, Russia_good_USSR_bad, Russia_good, USSR_history_good, neutral]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9199,"status":"ok","timestamp":1739809499513,"user":{"displayName":"Tatiana Chernova","userId":"14499696604272654483"},"user_tz":-300},"id":"VT4ycu6iiCQb","outputId":"293dd7ed-1457-4987-e98a-ebdfdc2f8a01"},"outputs":[{"output_type":"stream","name":"stdout","text":["Processing csv_folder USSR_history_bad\n","Processing 35 mm.csv\n","Processing Жизнь и Чувства.csv\n","Processing Иcтория c Мироновым Антоном.csv\n","Processing История ГУЛАГа.csv\n","Processing КиноРаритет.csv\n","Processing Музей «Следственная тюрьма НКВД».csv\n","Processing Наум, приди!.csv\n","Processing Север неизвестный.csv\n","Processing Узловые точки в истории человечества.csv\n","Processing частные суждения.csv\n","Processing Эдвард Радзинский.csv\n","Processing Русская дорога.csv\n","Processing Дм. Линдер Нетривиальная история.csv\n","Processing Военная история с Кириллом Шишкиным.csv\n","Processing Валерий Грачиков.csv\n","Processing Кинокритика экс-курильщика.csv\n","Processing История СССР в документах.csv\n","Processing csv_folder Russia_bad_relocate\n","Processing Простые решения.csv\n","Processing Жизнь в Испании, Коста Дель Соль.csv\n","Processing Relocator.cc.csv\n","Processing Азбука иммигранта.csv\n","Processing Граммарнаци.csv\n","Processing Илья Варламов.csv\n","Processing Кутовой про путешествия.csv\n","Processing Пора валить.csv\n","Processing Янчевский про коучинг.csv\n","Processing Кино, вино, домино - добавь жизни красок!.csv\n","Processing Антон Соколов.csv\n","Processing Першы.csv\n","Processing РЯБИНИН | ФОТОПУТЕШЕСТВИЯ.csv\n","Processing csv_folder Russia_good_USSR_bad\n","Processing Мысли о России.csv\n","Processing Невыдуманные истории.csv\n","Processing Oleg Alifanov.csv\n","Processing Истории от историка.csv\n","Processing Суаре у Клио ..csv\n","Processing Державное Движение России.csv\n","Processing Олег Макаренко.csv\n","Processing Филиал Карамзина.csv\n","Processing Егор Холмогоров.csv\n","Processing csv_folder Russia_good\n","Processing п0нты м0рала.csv\n","Processing Объясняю на пальцах.csv\n","Processing Олег Адольфович.csv\n","Processing Сергей Рязанцев.csv\n","Processing Дилетант о политике.csv\n","Processing Борис Новицкий.csv\n","Processing #делайчёхочешь.csv\n","Processing Путь к свободе.csv\n","Processing Natalia Szerebriakova.csv\n","Processing Александр Дугин (отец Дарьи).csv\n","Processing csv_folder USSR_history_good\n","Processing Война и Homo Sapiens.csv\n","Processing Жанна Швыдкая.csv\n","Processing Журнал \"Лучик\".csv\n","Processing История от историка.csv\n","Processing Так делал Сталин.csv\n","Processing Только факты.csv\n","Processing Школьный историк Виктор Тришкин.csv\n","Processing Тёмный историк.csv\n","Processing СССР.csv\n","Processing Наша история это Гордость.csv\n","Processing Всемирная история.csv\n","Processing Часовой истории.csv\n","Processing 📚 МемуаристЪ.csv\n","Processing Андрей Фурсов.csv\n","Processing Лев Валерич.csv\n","Processing Билет в СССР.csv\n","Processing Изнанка политики.csv\n","Processing Историк Игорь Гусев рассказывает….csv\n","Processing История с Андреем Журавлевым.csv\n","Processing Точка опоры..csv\n","Processing Ариян.csv\n","Processing Журнал «Фотон».csv\n","Processing Уральский историк.csv\n","Processing csv_folder neutral\n","Processing IQ Ladies | Блог нейрокосметолога Алевтины Коротовской.csv\n","Processing БиблиоЮлия.csv\n","Processing Вероника Воронова. Инженер на выгуле.csv\n","Processing ГалереуС.csv\n","Processing Евгений и Дарья Олейники .csv\n","Processing Занимательная диагностика | Pro.Diagnosi.csv\n","Processing Креативный Кот.csv\n","Processing Мr.Teacher.csv\n","Processing Мастер на все руки.csv\n","Processing Морена Морана.csv\n","Processing Музыка. История, открытия, мифы.csv\n","Processing Ника Марш.csv\n","Processing Почти ПП.csv\n","Processing Саша Док. Истории «03».csv\n","Processing СветЛость.csv\n","Processing Цветы для Элджернона.csv\n","Processing Это грибы!.csv\n","Processing вМесте.csv\n","Processing дневник ролевика.csv\n","Processing Юрист-юморист.csv\n","Processing Фельдшер.csv\n","Processing Камералкин.csv\n","Processing Жизнь в Англии.csv\n","Processing Дракон старой гвардии.csv\n","Processing Блог Доктора Шишонина.csv\n","Processing Анна Кирьянова. Философия жизни..csv\n","Processing Доктор Курпатов.csv\n","Processing sevprostor.csv\n","Processing Елена Чудинова.csv\n","Processing Записки кинезиолога.csv\n","Processing Мама на дзене.csv\n","Processing ⚠️ Инженерные знания.csv\n","1283\n","      Unnamed: 0             group               channel  \\\n","0              0  USSR_history_bad                 35 mm   \n","1              1  USSR_history_bad                 35 mm   \n","2              2  USSR_history_bad                 35 mm   \n","3              3  USSR_history_bad                 35 mm   \n","4              4  USSR_history_bad                 35 mm   \n","...          ...               ...                   ...   \n","1278           7           neutral  ⚠️ Инженерные знания   \n","1279           8           neutral  ⚠️ Инженерные знания   \n","1280           9           neutral  ⚠️ Инженерные знания   \n","1281          10           neutral  ⚠️ Инженерные знания   \n","1282          11           neutral  ⚠️ Инженерные знания   \n","\n","                subscribers               reads        dates  \\\n","0      24,9 тыс подписчиков      1830 прочтений       11 янв   \n","1      24,9 тыс подписчиков  13,2 тыс прочтений        9 янв   \n","2      24,9 тыс подписчиков  30,2 тыс прочтений  24 дек 2024   \n","3      24,9 тыс подписчиков  21,6 тыс прочтений        5 янв   \n","4      24,9 тыс подписчиков       393 прочтения  23 дек 2024   \n","...                     ...                 ...          ...   \n","1278  104,4 тыс подписчиков      2117 прочтений        7 янв   \n","1279  104,4 тыс подписчиков               3 мин        5 янв   \n","1280  104,4 тыс подписчиков  11,8 тыс прочтений        3 янв   \n","1281  104,4 тыс подписчиков       669 прочтений        2 янв   \n","1282  104,4 тыс подписчиков  24,7 тыс прочтений  27 дек 2024   \n","\n","                                   links  \\\n","0     https://dzen.ru/a/Z4JYNrCeRkIj2MQA   \n","1     https://dzen.ru/a/Z3-Iqa602E7yVQf0   \n","2     https://dzen.ru/a/Z2pQOiLy7FdJeYFc   \n","3     https://dzen.ru/a/Z3pd_r3DVWBfjfJN   \n","4     https://dzen.ru/a/Z2kWB1yl6QCXtnnM   \n","...                                  ...   \n","1278  https://dzen.ru/a/Z31EI3TG7C6KtFpW   \n","1279  https://dzen.ru/a/Z3ozI6602E7yfNvJ   \n","1280  https://dzen.ru/a/Z3fackFMDRXSIn3Z   \n","1281  https://dzen.ru/a/Z3ZlkZ9j5E0tXpkk   \n","1282  https://dzen.ru/a/Z25Kh2XA7F6USE3g   \n","\n","                                                  heads  \\\n","0     \"Первозданная Америка\" - жесткий сериал об осв...   \n","1              Какие сериалы стоит ожидать в 2025 году?   \n","2                  Лучшие сериалы, вышедшие в 2024 году   \n","3                    Сериалы, которые похожи на \"Извне\"   \n","4     \"Фоллаут\" - удачная киноадаптация игры про пос...   \n","...                                                 ...   \n","1278  Один случай, когда масса и правда может быть о...   \n","1279  Как был открыт \"электрический атом\"? Ну или эл...   \n","1280  У какого вещества сразу две температуры плавле...   \n","1281  Как проквантовать гравитационное поле? Гравито...   \n","1282  Если один фотон пропустить через призму, то бу...   \n","\n","                                                  texts  \n","0     Сериал Netflix \"Первозданная Америка\" («Americ...  \n","1     После вчерашнего путешествия в мир самых ожида...  \n","2     Конец года это лучшее время, чтобы оглянуться ...  \n","3     Если вам нравятся пугающие истории о загадочны...  \n","4     Показ второго сезона сериала \"Укрытие\" оживил ...  \n","...                                                 ...  \n","1278  Так уж повелось, что все физические тела облад...  \n","1279  В статьях я много раз отмечал, что как таковой...  \n","1280  В 1888 году австрийский учёный Фридрих Рейнитц...  \n","1281  В квантовой теории поля зависимость напряженно...  \n","1282  Наверняка вы догадываетесь откуда берется така...  \n","\n","[1283 rows x 9 columns]\n"]}],"source":["dfs = []\n","\n","csv_counter = 0\n","folder_counter = 0\n","\n","for url_group in url_list:\n","    csv_folder = f'/content/drive/MyDrive/Colab Notebooks/VKR/zen_dataframe_v2/{url_group[0]}'\n","    print('Processing csv_folder', url_group[0])\n","\n","    os.chdir(csv_folder)\n","    csv_files = [pos_csv for pos_csv in os.listdir(csv_folder) if pos_csv.endswith('.csv')]\n","\n","    for csv_file in csv_files:\n","      with open(csv_file, \"r\") as f:\n","          print(f'Processing {csv_file}')\n","          dfs.append(pd.read_csv(csv_file))\n","\n","final_df = pd.concat(dfs, ignore_index=True)\n","\n","print(len(final_df))\n","print(final_df)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DOb0IgkpiLe9"},"outputs":[],"source":["final_df.to_csv(f'/content/drive/MyDrive/Colab Notebooks/VKR/zen_dataframe_v2/channels_v2.csv', encoding='utf-8')"]}],"metadata":{"colab":{"provenance":[{"file_id":"1asPM0EmPjXV2kmEcLR80OrF8oK2UsXIp","timestamp":1736684413122},{"file_id":"1XRiLCWjNvSjhQlxW5sfGTSG71bMCGK3z","timestamp":1735280377576},{"file_id":"1lbckcwjlMa6ySIIosBvF4AlQBmRtc85f","timestamp":1733767057541}],"mount_file_id":"1kUmlEtgfZrAOQiYIK6nwQo-uQ9ueLzHq","authorship_tag":"ABX9TyPd8d1j6yRDyCKYDMWUXC1o"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}